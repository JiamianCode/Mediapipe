<!DOCTYPE html>
<html >
<head>
       <meta charset="utf-8"> 
       <title>播放本地的视频文件</title>
       <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.2/css/bulma.min.css">
       <!-- <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils@0.1/control_utils.css" crossorigin="anonymous"> -->
       <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils@0.6/control_utils.css" crossorigin="anonymous">
       <!-- <link rel="stylesheet" type="text/css" href="demo.css" crossorigin="anonymous"> -->
       <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils@0.1/camera_utils.js" crossorigin="anonymous"></script>
       <!-- <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils@0.1/control_utils.js" crossorigin="anonymous"></script> -->
       <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils@0.6/control_utils.js" crossorigin="anonymous"></script>
       <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils@0.2/drawing_utils.js" crossorigin="anonymous"></script>
       
       
       <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose@0.2/pose.js" crossorigin="anonymous"></script>
</head>
<body>
      <input type="file" id="file" accept="video/*">
      <video id="video5" controls style="display:none;"></video>
      <div id="output"></div>
      <script>
            // 初始化MediaPipe模型
            const pose = new Pose({
                  locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/pose@0.2/${file}`,
            });

            pose.onResults((results) => {
                  console.log(results.poseLandmarks); // 处理并显示结果
                  // 在这里添加代码来绘制结果到<canvas>或显示其他输出
            });

            // 监听文件输入变化
            document.getElementById('file').addEventListener('change', function(event) {
                  const file = event.target.files[0];
                  const url = URL.createObjectURL(file);
                  const video = document.getElementById('video5');
                  video.src = url;
                  video.style.display = 'block';

                  // 当视频数据加载后开始处理帧
                  video.onloadeddata = async () => {
                        await video.play();
                        function onFrame() {
                        if (video.paused || video.ended) {
                              return;
                        }
                        pose.send({image: video}).then(() => {
                              requestAnimationFrame(onFrame);
                        }).catch(e => console.error(e));
                        }
                        onFrame();
                  };
            });
    </script>
      </script>      
</body>
</html>